<!DOCTYPE html>
<html lang="en">

<head>
    <title>Miner template</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" >


    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>



</head>

<body>
  <div class="container">
   <h1>ChainAttacker:Blockchain Simulation System</h1>
   <input type='number' placeholder=2 value = 1 id='Chains'> # Chains
   <input type='number' placeholder=10 value = 1 id='Miners'> # Miners
   <input type='number' placeholder=30 value = 1 id='Blocks'> # Solved Blocks
   <input type='submit' onclick='sendParameters()'>
   <br><br><br><br>
   <div id='Ledger'>
     <table id='Account' style="border-collapse: separate; border-spacing: 10px;">
     </table>
   </div>
</div>

</body>
<script>
function sendParameters() {
  data = {
    'Chains': parseInt($("#Chains").val()),
    'Miners': parseInt($("#Miners").val()),
    'Blocks': parseInt($("#Blocks").val())
  };

  console.log(data);
  $.post("http://localhost:5000/send_parameters", data, function(result) {
    startSimulation()
  })
}

function startSimulation() {
  $.get('http://localhost:5000/ledger',function(result) {
    accountInfo = eval(result)['data']['account']
    sequenceInfo = eval(result)['data']['sequence']
    //$("#Ledger").empty().append(JSON.stringify(sequenceInfo))
    // Account Table
    $("#Account").empty().append("<tr><th>ID</th><th>Chain</th><th> Money </th> <th> Power </th></tr>")
    for (var i in accountInfo) {
      ids = Object.keys(accountInfo[i])
      for(var j = 0; j < ids.length; j++) {
        $("#Account").append("<tr cellpadding='5'>")
        $("#Account").append("<td>"+ids[j] + "     </td>")
        $("#Account").append("<td>"+i+"</td>")
        $("#Account").append("<td>"+accountInfo[i][ids[j]]['coins'] + "</td>")
        $("#Account").append("<td>"+accountInfo[i][ids[j]]['power'] + "</td>")
        $("#Account").append("</tr>")
      }
    }

  })
}


</script>

</html>
